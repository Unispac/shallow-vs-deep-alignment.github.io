<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="description"
        content="Safety Alignment Should Be Made More Than Just a Few Tokens Deep">
  <meta name="keywords" content="LLM, Safety Alignment, Adversarial Attacks">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Safety Alignment Should Be Made More Than Just a Few Tokens Deep</title>

  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-PYVRSFMDRL"></script>
  <script>
    window.dataLayer = window.dataLayer || [];

    function gtag() {
      dataLayer.push(arguments);
    }

    gtag('js', new Date());

    gtag('config', 'G-PYVRSFMDRL');
  </script>

  <link href="https://fonts.googleapis.com/css?family=Google+Sans|Noto+Sans|Castoro"
        rel="stylesheet">

  <link rel="stylesheet" href="./static/css/bulma.min.css">
  <link rel="stylesheet" href="./static/css/bulma-carousel.min.css">
  <link rel="stylesheet" href="./static/css/bulma-slider.min.css">
  <link rel="stylesheet" href="./static/css/fontawesome.all.min.css">
  <link rel="stylesheet"
        href="https://cdn.jsdelivr.net/gh/jpswalsh/academicons@1/css/academicons.min.css">
  <link rel="stylesheet" href="./static/css/index.css">
  <link rel="icon" href="./static/images/favicon.svg">

  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <script defer src="./static/js/fontawesome.all.min.js"></script>
  <script src="./static/js/bulma-carousel.min.js"></script>
  <script src="./static/js/bulma-slider.min.js"></script>
  <script src="./static/js/index.js"></script>
  <link rel="stylesheet" href="https://code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css">
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
  <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.min.js"></script>







  

  <style>
      body {
          overflow-x: hidden; /* Hide horizontal overflow */
      }
  </style>



  <style>
    .blue-text {
      color: blue;
    }
  </style>

  <style>
    .red-text {
      color: red;
    }
  </style>


<style>
  .video-wrapper {
      position: relative;
      overflow: hidden;
      width: 100%;
      padding-top: 56.25%; /* For 16:9 aspect ratio */
  }

  .video-frame {
      position: absolute;
      top: 0;
      left: 0;
      bottom: 0;
      right: 0;
      width: 100%;
      height: 100%;
      border: none;
  }

</style>
</head>
<body>


<section class="hero">
  <div class="hero-body">
    <div class="container is-max-desktop">
      <div class="columns is-centered">
        <div class="column has-text-centered">
          <h1 class="title is-1 publication-title">Defensive Prompt Patch: A Robust and Interpretable Defense of LLMs against Jailbreak Attacks</h1>
          <div class="is-size-5 publication-authors">
            <span class="author-block">
              <a href=""ï¼Œ rel="noopener noreferrer">Chen Xiong</a><sup>1</sup>,</span>
            <span class="author-block">
              <a href="https://unispac.github.io/">Xiangyu Qi</a><sup>2</sup>,</span>
            <span class="author-block">
              <a href="https://sites.google.com/site/pinyuchenpage/home">Pin-Yu Chen</a><sup>3</sup>,
            </span>
            <span class="author-block">
              <a href="https://tsungyiho.github.io/">Tsung-Yi Ho</a><sup>1</sup>,
            </span>
          </div>

          <div class="is-size-5 publication-authors">
            <span class="author-block"><sup>1</sup>The Chinese University of Hong Kong,</span>
            <span class="author-block"><sup>2</sup>Princeton University,</span>
            <span class="author-block"><sup>3</sup>IBM Research</span>
          </div>

          <!-- <div class="column has-text-centered">
            <div class="publication-links"> -->
              <!-- PDF Link. -->
              <!-- <span class="link-block">
                <a href="https://arxiv.org/pdf/2011.12948" 
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="fas fa-file-pdf"></i>
                  </span>
                  <span>Paper</span>
                </a>
              </span> -->

              <!-- Code Link. -->
              <!-- <span class="link-block">
                <a href="https://github.com/google/nerfies"
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="fab fa-github"></i>
                  </span>
                  <span>Code</span>
                  </a>
              </span> -->

          <!-- </div> -->
        </div>
      </div>
    </div>
  </div>
</section>




<section class="section">
  <div class="container is-max-desktop">
    <!-- Abstract. -->
    <div class="columns is-centered has-text-centered">
      <div class="column is-four-fifths">
        <h2 class="title is-3">Abstract</h2>
        <div class="content has-text-justified">
          <p>
            The safety alignment of current Large Language Models (LLMs) is vulnerable. Relatively simple attacks, or even benign fine-tuning, can jailbreak aligned models. We argue that many of these vulnerabilities are related to a shared underlying issue: safety alignment can take shortcuts, wherein the alignment adapts a model's generative distribution primarily over only its very first few output tokens. We refer to this issue as shallow safety alignment. In this paper, we present case studies to explain why shallow safety alignment can exist and provide evidence that current aligned LLMs are subject to this issue. We also show how these findings help explain multiple recently discovered vulnerabilities in LLMs, including the susceptibility to adversarial suffix attacks, prefilling attacks, decoding parameter attacks, and fine-tuning attacks. Importantly, we discuss how this consolidated notion of shallow safety alignment sheds light on promising research directions for mitigating these vulnerabilities. For instance, we show that deepening the safety alignment beyond just the first few tokens can often meaningfully improve robustness against some common exploits. We also design a regularized fine-tuning objective that makes the safety alignment more persistent against fine-tuning attacks by constraining updates on initial tokens. Overall, we advocate that future safety alignment should be made more than just a few tokens deep.
          </p>
        </div>
      </div>
    </div>

</section>

<section class="section">
<div class="container is-max-desktop">
    <!-- Abstract. -->
<div class="columns is-centered has-text-centered">
<div class="content has-text-justified">
<p>We summarized some recent advances in <strong>Jailbreak Attack</strong> and <strong>Jailbreak Defense</strong> in the below table: </p>
<div id="tabs">
  <ul>
    <li><a href="#jailbreak-attacks">Jailbreak Attack</a></li>
    <li><a href="#jailbreak-defenses">Jailbreak Defense</a></li>
  </ul>
  <div id="jailbreak-attacks">  
    <div id="accordion-attacks">
      <h3>GCG</h3>
      <div>
        <ul>
          <li>Paper: <a href="https://arxiv.org/abs/2307.15043" target="_blank" rel="noopener noreferrer">
            Universal and Transferable Adversarial Attacks on Aligned Language Models</a></li>
          <li>Overview: GCG focuses on optimizing adversarial suffixes given inputs. This method employs gradient-based optimizations to tailor the suffixes in a way that induces LLMs to generate harmful outputs for each individual 
            malicious user query. GCG attack outputs the tailored suffixes and append with the each harmful query to form the new jailbreak prompt. Such jailbreak prompts exploit model vulnerabilities, 
            making them a potent tool for generating misaligned responses from even well-aligned models. </li>
        </ul>
      </div>
      <h3>AutoDAN</h3>
      <div>
        <ul>
          <li>Paper: <a href="https://arxiv.org/abs/2310.04451" target="_blank" rel="noopener noreferrer">
            AutoDAN: Generating Stealthy Jailbreak Prompts on Aligned Large Language Models</a></li>
          <li>Overview: AutoDAN introduces a dynamic adversarial training framework that continuously adapts to model responses.It utilizes the Genetic Algorithm (GA) and Hierarchical Genetic Algorithm (HGA) 
            to optimize iterative upon a prototype jailbreak prompt and produce high quality jailbreak prompt. Unlike GCG attack, AutoDAN produces interpretable jailbreak prompts.
          </li>
        </ul>
      </div>
      <h3>PAIR</h3>
      <div>
        <ul>
          <li>Paper: <a href="https://arxiv.org/abs/2310.08419" target="_blank" rel="noopener noreferrer">
            Jailbreaking Black Box Large Language Models in Twenty Queries</a></li>
          <li>Overview: PAIR uses an attacker LLM to iteratively generate and refine jailbreak prompts with black-box access to a target LLM. This method demonstrates high efficiency to generate a semantic jailbreak. 
            They bypass the need for extensive human involvement by automating the generation of prompt-level jailbreaks, blending creativity with algorithmic precision.</li>
        </ul>
      </div>
      <h3>TAP</h3>
      <div>
        <ul>
          <li>Paper: <a href="https://arxiv.org/abs/2312.02119" target="_blank" rel="noopener noreferrer">
            Tree of Attacks: Jailbreaking Black-Box LLMs Automatically</a></li>
          <li>Overview: TAP is similar to PAIR. The main difference is that 
            the attacker in TAP iteratively refines candidate (attack) prompts using tree-of-thought 
            reasoning.</li>
        </ul>
      </div>
      <h3>Base64</h3>
      <div>
        <ul>
          <li>Paper: <a href="https://arxiv.org/abs/2307.02483" target="_blank" rel="noopener noreferrer">
            Jailbroken: How Does LLM Safety Training Fail?</a></li>
          <li>Overview: This form of attack transform the original malicious user query into the Base64 format representation. 
            It is shown in the work that such a transformation will lead the LLM to produce positive responses for such harmful request.</li>
        </ul>
      </div>
      <h3>ICA</h3>
      <div>
        <ul>
          <li>Paper: <a href="https://arxiv.org/pdf/2310.06387" target="_blank" rel="noopener noreferrer">
            Jailbreak and Guard Aligned Language Models with Only Few In-Context Demonstrations</a></li>
          <li>Overview:  ICA leverages In-Context Learning to manipulate the alignment of LLMs by adding harmful demonstrations within the input prompt. 
            This approach effectively subverts LLMs with strategically crafted examples that coax the model into generating harmful content. 
            ICA demonstrates a unique utilization of in-context examples to significantly alter model behavior without requiring modifications to the model's parameters, 
            showcasing a novel method of influencing LLM safety through minimal yet targeted inputs.</li>
        </ul>
      </div>
      <h3>Catastrophic</h3>
      <div>
        <ul>
          <li>Paper: <a href="https://arxiv.org/abs/2310.06987" target="_blank" rel="noopener noreferrer">
            Catastrophic Jailbreak of Open-source LLMs via Exploiting Generation</a></li>
          <li>Overview:  This method disrupts LLMs' alignment by tweaking generation configurations, such as decoding hyper-parameters and sampling methods. 
            By altering these configurations, attackers can trigger misaligned responses in safety-tuned models, highlighting a critical vulnerability in current safety evaluation processes. 
            This technique, can be categorized as "Decoding-Based Attack", in which achieving high Attack Success Rate at a fraction of the computational cost.</li>
        </ul>
      </div>
    </div>
  </div>

  <div id="jailbreak-defenses">  
    <div id="accordion-defenses">
      <h3>RPO</h3>
      <div>
        <ul>
          <li>Paper: <a href="https://arxiv.org/abs/2401.17263" target="_blank" rel="noopener noreferrer">
            Robust Prompt Optimization for Defending Language Models Against Jailbreaking Attacks</a></li>
          <li>Overview: This is also a system prompt based defense, in which it alters the GCG attack and replace the objective of GCG into minimizing the distance between jailbreak query responses and refusal responses. 
            Due to the uninterpretability of GCG suffix, RPO also outputs suffixes that come with high perplexity.</li>
        </ul>
      </div>
      <h3>Goal Prioritization</h3>
      <div>
        <ul>
          <li>Paper: <a href="https://arxiv.org/pdf/2311.09096" target="_blank" rel="noopener noreferrer">
            Defending Large Language Models Against Jailbreaking Attacks Through Goal Prioritization</a></li>
          <li>Overview: This is a hand-written system defense prompt. 
            Particularly, Goal Prioritization ask the LLM to prioritize safety over helpfulness by enabling the model to have the process of Internal Thoughts before outputting the final responses.
          </li>
        </ul>
      </div>
      <h3>Default system Prompt</h3>
      <div>
        <ul>
          <li>Paper: <a href="https://arxiv.org/abs/2401.18018" target="_blank" rel="noopener noreferrer">
            On Prompt-Driven Safeguarding for Large Language Models</a></li>
          <li>Overview: Similar to Goal Prioritization, system prompt is also a hand-written system defense prompt and it declares the role of LLM to be safe and should not generate harmful responses.</li>
        </ul>
      </div>
      <h3>Self-Reminder</h3>
      <div>
        <ul>
          <li>Paper: <a href="https://assets.researchsquare.com/files/rs-2873090/v1_covered_eb589a01-bf05-4f32-b3eb-0d6864f64ad9.pdf?c=1702456350" target="_blank" rel="noopener noreferrer">
            Defending ChatGPT against Jailbreak Attack via Self-Reminder</a></li>
          <li>Overview: Self-Reminder modifying the system prompt of the target LLM so that the model reminds itself to process 
            and respond to the user in the context of being an aligned LLM.</li>
        </ul>
      </div>
    </div>
  </div>
  
</div>
</div>
</div>
</div>
</section>

<section class="section">
  <div class="container is-max-desktop">

    <div class="columns is-centered">
      <div class="container-centered">
        <div>
            <img src="./static/images/method_plot_v8.png"
                 class="method_overview"
                 alt="Methodlogy Overview of DPP"/>
            <p>Overview of <strong>Defensive Prompt Patch</strong>. (a) showcases an example of jailbreak attacks. 
              (b) is the DPP training phase in which the algorithm takes in the refusal and helpful datasets and a prototype of the defense prompt. 
              Then, the algorithm forms the defense prompt population by revising the prototype using LLM. For each of the defense prompts in the population, 
              the algorithm will evaluate the defense and utility scores. The algorithm keeps editing the defense prompts with low scores using the Hierarchical Genetic Search algorithm. 
              (c) shows the deployment of DPP in the LLM inference phase, by adding the best DPP in (b) (indicated in green patch) to every input query. 
              (d) shows the trade-off graphs between the win-rate (utility) and attack success rate (ASR) in both LLAMA-2-7B-Chat and Mistral-7B-Instruct-v0.2 models for different defenses. </p>
        </div>
    </div>


</section>

<section class="section">
<div class="container is-max-desktop">
<div class="columns is-centered">
<div class="container-centered">
<div class="row">
  <div class="col-md-10 col-md-offset-1">
  <h3 id="Demo">
  Demo:
  </h3>
  <div class="text-justify">
  We present a few jailbreak examples of the performance of our trained DPPs under both LLAMA-2-7B-Chat and MISTRAL-7B-Instruct-v0.2 models. <span class="red-text">Note that some of the response contents contain harmful information.</span>
  </div>
  <br />
  <!-- Adding a dropdown for example selection -->



  <h4>
      <span style="font-weight: bold; font-size: larger; text-decoration: underline;">Examples of DPP performance under different jailbreak attacks (LLAMA-2-7B-Chat)</span>;
  </h4>
  
  <!-- First set of controls and output containers -->
  <div id="outputAndControlsContainer">
      <div id="controlsContainer">
          <div id="exampleSelectorContainer">
              <label for="exampleSelector">Select an Jailbreak Attack:</label>
              <select id="exampleSelector" onchange="handleChange('exampleSelector', 'model1Output', 'model2Output', 0, 1, model1Texts, model2Texts, userTexts, userTexts2)">
                  <option value="" disabled selected>Please click to select</option>  
                  <option value="example1">Example 1 -- GCG</option>
                  <option value="example2">Example 2 -- AutoDAN</option>
                  <option value="example3">Example 3 -- PAIR</option>
                  <option value="example4">Example 4 -- TAP</option>
                  <!-- Add more options as needed -->
              </select>
          </div>
      </div>
  
      <div id="outputContainer">
          <div id="chatbot1" class="chatbotOutput">
              <div class="chatbotHeader">
                  <span style="font-weight: bold; font-size: larger;">No Defense LLAMA-2-7B-Chat</span>
              </div>
              <div id="model1Output" class="output-container"></div>
          </div>
  
          <div id="chatbot2" class="chatbotOutput">
              <div class="chatbotHeader">
                  <span style="font-weight: bold; font-size: larger;">LLAMA-2-7B-Chat with DPP</span>
              </div>
              <div id="model2Output" class="output-container"></div>
          </div>
      </div>
  </div>
  <br/>

  <h4>
    <span style="font-weight: bold; font-size: larger; text-decoration: underline;">Examples of DPP performance under different jailbreak attacks (MISTRAL-7B-Instruct-v0.2)</span>;
  </h4>

  <div id="outputAndControlsContainer2">
    <div id="controlsContainer2">
        <div id="exampleSelectorContainer2">
            <label for="exampleSelector2">Select an Jailbreak Attack:</label>
            <select id="exampleSelector2" onchange="handleChange('exampleSelector2', 'model3Output', 'model4Output', 2, 3, model3Texts, model4Texts, userTexts3, userTexts4)">
              <option value="" disabled selected>Please click to select</option>  
              <option value="example1">Example 1 -- GCG</option>
              <option value="example2">Example 2 -- AutoDAN</option>
              <option value="example3">Example 3 -- PAIR</option>
              <option value="example4">Example 4 -- TAP</option>
                <!-- Add more options as needed -->
            </select>
        </div>
    </div>

    <div id="outputContainer2">
        <div id="chatbot3" class="chatbotOutput">
            <div class="chatbotHeader">
                <span style="font-weight: bold; font-size: larger;">No Defense MISTRAL-7B-Instruct-v0.2</span>
            </div>
            <div id="model3Output" class="output-container"></div>
        </div>

        <div id="chatbot4" class="chatbotOutput">
            <div class="chatbotHeader">
                <span style="font-weight: bold; font-size: larger;">MISTRAL-7B-Instruct-v0.2 with DPP</span>
            </div>
            <div id="model4Output" class="output-container"></div>
        </div>
    </div>
  </div>
  <br />
</div>
</div>
</div>
</section>


<section class="section">
  <div class="container is-max-desktop">
  <div class="columns is-centered">
  <div class="container-centered">
<div class="row">
  <div class="col-md-10 col-md-offset-1">

    <h3 id="ethics">Ethics and Disclosure</h3>
    <div class="text-justify">
    <ul>
        <li>
              <p>In the development and presentation of our research paper, which investigates methods for jailbreaking large language models (LLMs) through the use of our proposed Defensive Prompt Patch (DPP), we are committed to adhering to the highest ethical standards. Our research aims to explore the robustness and resilience of LLMs to advanced prompting strategies, thereby contributing to the broader understanding of their vulnerabilities and enhancing their security frameworks.</p>
          
              <h2>Ethical Considerations:</h2>
              <ul>
                  <li><strong>Security Research Purpose:</strong> The techniques and examples provided in this paper, including the jailbreak prompts demonstrated in the Demo section, are intended solely for academic and security research purposes. Our goal is to assist in the identification and subsequent mitigation of vulnerabilities within LLMs.</li>
                  <li><strong>No Malicious Intent:</strong> The jailbreak prompts and methods discussed are not designed or intended for malicious use. They are developed to provide insights into potential security weaknesses, which can be crucial for developers and researchers working on strengthening the defensive capabilities of these models.</li>
                  <li><strong>Responsible Disclosure:</strong> Prior to the publication of our findings, we engaged in a responsible disclosure process with the developers of the targeted LLMs. This was to ensure that they were aware of potential vulnerabilities and had the opportunity to address them, thereby minimizing the risk of exploitation.</li>
              </ul>
          
              <h2>Disclosure:</h2>
              <ul>
                  <li><strong>Transparency:</strong> We disclose that the jailbreak prompts and methods outlined in our paper are theoretical and experimental in nature. While we demonstrate their effectiveness in controlled environments, real-world applications could differ based on various factors including model configurations and updates.</li>
                  <li><strong>Limitations on Use:</strong> While we provide detailed descriptions and demonstrations of jailbreaking techniques, we do not endorse or encourage their use outside of a controlled, ethical research environment. We strongly advise against the application of these techniques in any manner that could potentially harm individuals or compromise the integrity and security of any system.</li>
                  <li><strong>Collaboration and Compliance:</strong> Our research has been conducted in collaboration with ethical security researchers and with compliance to all relevant legal and ethical guidelines. We emphasize the importance of ongoing collaboration between academia, industry, and security professionals to continue improving the security of LLMs.</li>
              </ul>
    <br><br>
    </div>
  </div>
</div>
</div>
</div>
</div>
</section>




<footer class="footer" style="background-color: white;">
  <div class="container">
      <p class="text-muted">
          Acknowledgements: The website template was borrowed from
          <a href="https://llm-tuning-safety.github.io/"target="_blank">LLM Finetuning Risks</a>,
          <a href="https://climatenerf.github.io/" target="_blank">ClimateNeRF</a>, 
          <a href="http://mgharbi.com/" target="_blank">MichaÃ«l Gharbi</a>, 
          <a href="https://dorverbin.github.io/refnerf/index.html" target="_blank">RefNeRF</a>, 
          <a href="https://nerfies.github.io/" target="_blank">Nerfies</a> 
          and <a href="https://hhsinping.github.io/svs/supp/visual_comparison.html" target="_blank">Semantic View Synthesis</a>.
      </p>
  </div>
</footer>

</body>
</html>
